window.Marx=function(e){var t=this;this._url="http://marxjs.com";return $.getJSON(""+this._url+"/characters",function(n){t.marx_json=n;return t.initialize(e)})};$.extend(Marx.prototype,{settings:{controls:"standard",position:"bottom-right",form:"",ipsum:3,max_ipsum:10},effected:{inputs:0,texareas:0,selects:0,check_boxes:0,radio_buttons:0,hidden_fields:0},initialize:function(e){$.extend(this.settings,e);return this.create_controls()},create_controls:function(){var e,t=this;$("body").append('<div class="marx-js-controls '+this.settings.position+'">\n</div>');this.$el=$(".marx-js-controls");e=this.settings.controls!=="toggle-all"?"<a href='#open-controls' class='open-controls'>Marx.js</a>":'<div class="open-controls">\n  <a href="#advanced-controls" class="advanced-controls" title="Show Advanced Controls">Advanced Controls</a>\n  <a href="#standard-controls" class="standard-controls" title="Show Standard Controls">Standard Controls</a>\n  <a href="#populate-whole-form" class="quick-populate" title="Populate Whole Form">Marx.js</a>\n</div>';this.$el.append(e);this.$el.addClass("marx-js-collapsed");switch(this.settings.controls){case"standard":this.add_standard_controls();return this.$("a.open-controls").click(function(e){return t.toggle_controls(e)});case"advanced":case"toggle-advanced":this.add_standard_controls();this.add_advanced_controls();return this.$("a.open-controls").click(function(e){return t.toggle_controls(e)});case"minimum":return this.$("a.open-controls").click(function(e){return t.populate_whole_form(e)});case"toggle-all":this.add_standard_controls();this.add_advanced_controls();this.$("a.standard-controls").click(function(e){$("p.marx-notification").remove();t.$(".marx-standard-controls").toggle();t.$(".marx-advanced-controls").hide();return false});this.$("a.advanced-controls").click(function(e){$("p.marx-notification").remove();t.$(".marx-advanced-controls").toggle();t.$(".marx-standard-controls").hide();return false});return this.$("a.quick-populate").click(function(e){t.$(".marx-standard-controls").hide();t.$(".marx-advanced-controls").hide();return t.populate_whole_form(e)})}},$:function(e){return this.$el.find(e)},add_standard_controls:function(){var e,t,n,r,i,s=this;t='<div class="marx-standard-controls">\n  <h4>Populate Form Fields</h4>\n</div>';this.$(".open-controls").before(t);i=[["populate-whole-form","Populate Whole Form"],["populate-textareas","Populate TextAreas"],["populate-inputs","Populate Inputs"],["populate-checkboxes","Populate Check Boxes"],["populate-radios","Populate Radio Buttons"],["populate-selects","Populate Select Boxes"]];for(n=0,r=i.length;n<r;n++){e=i[n];$(".marx-standard-controls").append(this.build_action(e))}return this.$(".marx-standard-controls a").click(function(e){return s.popluate_selected_fields(e)})},add_advanced_controls:function(){var e,t,n,r,i,s=this;t='<div class="marx-advanced-controls">\n  <h4>Advanced Options</h4>\n</div>';this.$(".open-controls").before(t);i=[["clear-form","Clear Form"],["populate-submit","Populate and Submit"],["show-hidden",'<span data-text="Hide">Show</span> Hidden Fields'],["expand-select",'<span data-text="Collapse">Expand</span> Select Boxes'],["random-image","Download Random Image"],["generate-ipsum","Generate Ipsum <p class='ipsum'><input type='number' value='"+this.settings.ipsum+"' max=''"+this.settings.max_ipsum+"' /> Paragraphs</p>"]];for(n=0,r=i.length;n<r;n++){e=i[n];$(".marx-advanced-controls").append(this.build_action(e))}if(this.settings.controls==="toggle-advanced"){this.set_toggle_advanced()}return this.$(".marx-advanced-controls a").click(function(e){return s.advanced_actions(e)})},build_action:function(e){return'<div class="marx-js-group">\n  <a href="#'+e[0]+'" class="'+e[0]+'">Go</a>\n  <p>'+e[1]+"</p>\n</div>"},set_toggle_advanced:function(){var e=this;this.$(".marx-advanced-controls").hide();this.$(".marx-standard-controls").append("<a href='#advanced' class='marx-toggle-advanced'>&laquo; Advanced</a>");return this.$("a.marx-toggle-advanced").click(function(t){return e.toggle_advanced($(t.target))})},populate_whole_form:function(e){this.populate_inputs();this.populate_textareas();this.populate_checkboxes();this.populate_radios();this.populate_selects();return false},populate_inputs:function(){var e=this;this.effected.inputs=0;return $.each($(""+this.settings.form+" input"),function(t,n){var r,i,s,o,u,a,f,l;if(!($(n).val()!==""||$(n).hasClass("no-populate"))){s=e.get_random();r=JSON.parse(s.brother);i=JSON.parse(s.movie);a=[r.name,i.name,s.first_name,s.last_name,s.description].filter(function(){return true});f=function(){switch($(n).attr("type")){case"number":return i.year;case"email":return""+r.name.toLowerCase().replace(/\s/g,"")+"@"+i.name.toLowerCase().replace(/\s/g,"")+".com";case"url":return"http://"+i.name.toLowerCase().replace(/\s/g,"")+".com";case"date":o=Math.random();l=i.year.toString();return""+l+"-0"+l.substr(Math.floor(o*4),1)+"-2"+l.substr(Math.floor(o*4),1);default:u=a[Math.floor(Math.random()*a.length)];if(u==null||u===""){return"Marx"}else{return u}}}();if(["checkbox","radio","hidden"].indexOf($(n).attr("type")<0)){$(n).attr("data-marx-d",true).val(f).trigger("change").trigger("blur");return e.effected.inputs+=1}}})},populate_textareas:function(){var e=this;this.effected.textareas=0;return $.getJSON(""+this._url+"/quotes",function(t){return $.each($(""+e.settings.form+" textarea"),function(n,r){e.effected.textareas+=1;return $(r).attr("data-marx-d",true).val(t[Math.floor(Math.random()*t.length)].body).trigger("change").trigger("blur")})})},populate_checkboxes:function(){var e,t=this;this.effected.check_boxes=0;e=[];$.each($(""+this.settings.form+" input[type=checkbox]"),function(t,n){if(!(e.indexOf($(n).attr("name"))>=0)){return e.push($(n).attr("name"))}});return $.each(e,function(e,n){var r,i;r=Math.floor(Math.random()*2)===1?true:false;i=n.replace(/\[/g,"\\[").replace(/\]/g,"\\]");$(""+t.settings.form+" input[name="+i+"]").attr("data-marx-d",true).attr("checked",r).trigger("change").trigger("blur");if(r){return t.effected.check_boxes+=1}})},populate_radios:function(){var e,t=this;this.effected.radio_buttons=0;e=[];$(""+this.settings.form+" input[type=radio]").each(function(t,n){if(!(e.indexOf($(n).attr("name"))>=0)){return e.push($(n).attr("name"))}});return $.each(e,function(e,n){var r,i;r=n.replace(/\[/g,"\\[").replace(/\]/g,"\\]");i=$(""+t.settings.form+" input[name="+r+"]").length;$(""+t.settings.form+" input[name="+n+"]:eq("+Math.floor(Math.random()*i)+")").attr("data-marx-d",true).attr("checked",true).trigger("change").trigger("blur");return t.effected.radio_buttons+=1})},populate_selects:function(){var e=this;this.effected.selects=0;return $(""+this.settings.form+" select").each(function(t,n){var r,i,s;e.effected.selects+=1;s=$(n).attr("data-marx-d",true).find("option").length;i=Math.floor(Math.random()*s);r=$(n).find("option:eq("+i+")");if(r.attr("value")!=null&&r.attr("value")!==""){r.attr("selected",true)}else{r.next("option").attr("selected",true)}return $(n).trigger("change").trigger("blur")})},toggle_hidden_fields:function(){var e=this;this.effected.hidden_fields=0;$(""+this.settings.form+" input[data-marx-hidden=true]").each(function(t,n){var r;r=$(n).attr("type")==="hidden"?"text":"hidden";$(n).attr("type",r);return e.effected.hidden_fields+=1});return $(""+this.settings.form+" input[type=hidden]").each(function(t,n){if($(n).data("marx-d")==null){e.effected.hidden_fields+=1;return $(n).attr("type","text").attr("data-marx-d",true).attr("data-marx-hidden",true)}})},trigger_notifications:function(){var e,t=this;e=0;return $.each(this.effected,function(n,r){var i,s;if(r!==0){s=n.replace(/_/," ");i=$("<p class='marx-notification'>"+r+" "+s+" elements were altered</p>");t.$el.append(i);i.css("top",""+(20+e*50)+"px").delay(5e3+e*50).slideUp("fast",function(){return i.remove()});e+=1;return t.effected[n]=0}})},toggle_description:function(e){var t,n,r,i;t=e.parent(".marx-js-group");n=t.find("p span");i=n.data("text");r=n.text();return n.text(i).data("text",r)},generate_ipsum:function(){var e,t,n=this;$(".marx-generated-ipsum").remove();t=this.$(".ipsum input").val();e=$("<div class='marx-generated-ipsum "+this.settings.position+"'>\n  <h4>Marx Ipsum</h4>\n  <a href='#close' class='marx-ipsum-close'>X</a>\n  <div class='marx-container'></div>\n</div>");$("body").append(e);return $.getJSON(""+this._url+"/monologues",function(n){var r,i,s,o;i=t>n.length?n.length-1:t;s=n.sort(function(){return.5-Math.random()});for(r=o=1;1<=i?o<=i:o>=i;r=1<=i?++o:--o){e.find(".marx-container").append("<p>"+s[r].body+"</p>")}return $("a.marx-ipsum-close").click(function(e){$(".marx-generated-ipsum").slideUp("fast");return false})})},get_random:function(){return this.marx_json[Math.floor(Math.random()*this.marx_json.length)]},toggle_controls:function(e){$("p.marx-notification").remove();this.$el.toggleClass("marx-js-collapsed");if(this.settings.controls==="toggle-advanced"&&this.$el.hasClass("marx-js-collapsed")){if($(".marx-advanced-controls").is(":visible")){this.toggle_advanced($("a.marx-toggle-advanced"))}}return false},toggle_advanced:function(e){var t;t=e.hasClass("opened")?"&laquo; Advanced":"Close &raquo;";e.toggleClass("opened").html(t);this.$(".marx-advanced-controls").toggle();return false},popluate_selected_fields:function(e){switch($(e.target).attr("class")){case"populate-textareas":this.populate_textareas();break;case"populate-inputs":this.populate_inputs();break;case"populate-checkboxes":this.populate_checkboxes();break;case"populate-radios":this.populate_radios();break;case"populate-selects":this.populate_selects();break;default:this.populate_whole_form()}this.trigger_notifications();return false},advanced_actions:function(e){var t=this;switch($(e.target).attr("class")){case"clear-form":$("input[data-marx-d=true], textarea[data-marx-d=true]").val("");$("input[type=checkbox], input[type=radio]").each(function(e,t){if($(t).data("marx-d")!=null===$(t).data("marx-d")&&true){return $(t).removeAttr("checked")}});$("select[data-marx-d=true] option:eq(0)").attr("selected",true);break;case"populate-submit":$.when(this.populate_whole_form()).then(function(){$(e.target).replaceWith("<span class='spinner'>Loading</span>");return setTimeout(function(){return $("form").submit()},500)});break;case"show-hidden":this.toggle_description($(e.target));$.when(this.toggle_hidden_fields()).then(function(){return t.trigger_notifications()});break;case"expand-select":this.toggle_description($(e.target));$("select").each(function(e,t){if($(t).attr("size")!=null){return $(t).removeAttr("size")}else{return $(t).attr("size",$(t).find("option").length)}});break;case"random-image":window.location=""+this._url+"/get-image";break;case"generate-ipsum":this.generate_ipsum()}return false}})